// MyPage (Click2Zap Improved)

/*
MyPage puts you in control of the current page: Remove, isolate, edit page items with keyboard control. On-screen print-preview emulation lets you see how the page will print while editing.

Usage
- Click to select/deselect elements (can select multiple)
- Perform actions via keyboard (mouse over [?] in the top right corner)

R - Remove selected element(s)
U - Undo removal
I - Isolate selected elements (removes everything else!) 
P - Print-Preview (wonâ€™t be 100% accurate, but itâ€™s faster than native print-preview on any browser Iâ€™ve used, and you can even reverse it in IE, FF & Opera. This is perfect for adjusting pages for print)
W - Widen last selected element (a selected table cell becomes a selected table row, etc.)
B - Backwards (move selection to the previous element) 
N - Next (move selection to the next element)
D - Deselect all
C - Copy the last selected element (duplicate is placed directly after the original) 
E - Edit HTML (of the last selected element)
Esc - Escape/Quit

Found at http://mrclay.org/index.php/2006/04/23/mypage-bookmarklet/
*/

javascript:javascript:(function(){var%20d=document,i=0,l,em=0,ed,b=d.body,w=window,sl=[],hid=[],$=b.getElementsByTagName('*'),cTp=(d.all&&!w.opera)?'absolute':'fixed',css=d.createElement('style');css.type='text/css';css.media='all';var%20cT='#mPp{font-size:15px;padding:5px;background:#fdd;color:#000;position:'+cTp+';top:0;right:0;zIndex:1000;text-align:right}#mPp:hover{padding:.5em;line-height:1.6;}#mPp:hover%20u{display:none}#mPp%20i{display:none;text-align:left;cursor:default;color:#000}#mPp:hover%20i{display:block}#mPp%20b{border:1px%20outset%20#000;background:#fff;color:#666;padding:0%202px;margin-right:4px}#mPe{position:absolute;left:0;right:0;padding:5px%2010px;background:#fdd;text-align:left}#mPe%20textarea{width:99%;display:block}'+'.mPs,.mPs%20*{background:#ff0;color:#000;}.mPh{background:#ffc;}.mPi,.mPi%20*{background:#fff;width:auto;float:none;margin:1em%200;padding:0;}body.mPi{text-align:left;margin:0;}'.replace(/;/g,'%20!important;');if(css.styleSheet)css.styleSheet.cssText=cT;else%20css.appendChild(d.createTextNode(cT));d.getElementsByTagName('head')[0].appendChild(css);function%20nB(e){if(!e)var%20e=w.event;e.cancelBubble=true;if(e.stopPropagation)e.stopPropagation()}function%20over(e){nB(e);!em&&!this.isSel&&changeCn(this,'mPh')}function%20out(e){nB(e);!em&&!this.isSel&&changeCn(this)}function%20clik(e){nB(e);!em&&this.isSel?unSel(this):sel(this);return%20false}while(l=$.item(i++)){addEvents(l)}var%20h=d.createElement('a');h.id='mPp';h.href='http://mrclay.org/';h.innerHTML='<u>?</u><i><b>R</b>emove%20Selected</i><i><b>U</b>ndo%20Remove</i><i><b>I</b>solate%20Selected</i><i><b>P</b>rint%20Preview</i><i><b>W</b>iden%20Selected</i><i><i><b>B</b>ackwards</i><b>N</b>ext</i><i><b>D</b>eselect</i><i><b>C</b>opy%20Element</i><i><b>E</b>dit%20HTML</i><i><b>Esc</b>ape/Quit</i>';h.onclick=function(e){nB(e)};b.appendChild(h);d.onkeydown=function(e){var%20ls=sl.length?sl[sl.length-1]:0;if(!e)var%20e=window.event;if(e.keyCode==27){rm(h);rm(css);i=0;while(l=$.item(i++)){l.onmouseover=l.oldOnmouseover||null;l.onmouseout=l.oldOnmouseout||null;l.onclick=l.oldOnclick||null;l.oldOnmouseover=null;l.oldOnmouseout=null;l.oldOnclick=null}d.onkeydown=null;em&&rm(ed)}if(em)return%20true;switch(e.keyCode){case%2082:while(sl.length){ls=sl[sl.length-1];ls.style.display='none';unSel(ls);hid.push(ls)}break;case%2073:sel(h);while(b.hasChildNodes())b.removeChild(b.firstChild);while(sl.length){b.appendChild(sl[0]);unSel(sl[0])}break;case%2087:if(ls){unSel(ls);(ls!=b)&&sel(ls.parentNode)}break;case%2080:pp();break;case%2068:unSel(ls);break;case%2085:hid.length&&(hid.pop().style.display='');break;case%2069:ls&&ls.innerHTML&&edit(ls);break;case%2066:if(ls){l=d.getElementsByTagName('*').item(getSourceIndex(ls)-1);if(l&&l!=b){unSel(ls);sel(l)}}break;case%2078:if(ls){l=d.getElementsByTagName('*').item(getSourceIndex(ls)+1);if(l&&l!=h){unSel(ls);sel(l)}}break;case%2067:if(ls){l=ls.cloneNode(true);if(ls.id){l.id+='_copy'}ls.parentNode.insertBefore(l,ls.nextSibling);addEvents(l);i=0;var%20desc;while(desc=l.getElementsByTagName('*').item(i++))addEvents(desc);unSel(ls);sel(l)}break;default:return%20true}return%20false};function%20rm(l){l.parentNode.removeChild(l)}function%20changeCn(l,cN){l.className=l.className.replace(/\bmP[hs]\b/g,'');if(cN)l.className+=l.className?'%20'+cN:cN}function%20sel(l){changeCn(l,'mPs');l.isSel='1';sl.push(l)}function%20unSel(l){changeCn(l);l.isSel='';for(var%20i=0,len=sl.length;i<len;i++){if(sl[i]==l){sl.splice(i,1);return}}}function%20edit(l){em=1;var%20left=0,top=0,tmp=l,chg=0;if(tmp.offsetParent){while(tmp.offsetParent){left+=tmp.offsetLeft;top+=tmp.offsetTop;tmp=tmp.offsetParent}}ed=d.createElement('div');ed.id='mPe';b.appendChild(ed);ed.style.top=(top+l.offsetHeight+5)+'px';unSel(l);var%20oh=getOuterHTML(l).replace(/^\s*|\s*$/g,'').replace(/%20isSel[<>]*\u003E/g,'>').replace(/%20class=""(?=[^<>]*>)/g,'');sel(l);var%20rows=Math.min(15,oh.split('\n').length+3);ed.innerHTML='<textarea%20id=mPta%20rows='+rows+'></textarea><button%20id=mPbu>done</button>';d.getElementById('mPta').value=oh;d.getElementById('mPta').onchange=function(){chg=1};function%20finEdit(){unSel(l);em=0;if(chg){var%20tmp=b.appendChild(d.createElement('div'));tmp.innerHTML=d.getElementById('mPta').value;i=0;var%20desc;while(desc=tmp.getElementsByTagName('*').item(i++))addEvents(desc);while(tmp.hasChildNodes())l.parentNode.insertBefore(tmp.firstChild,l);rm(l);rm(tmp)}rm(ed)}d.getElementById('mPbu').onclick=d.getElementById('mPbu').onkeypress=finEdit}function%20addEvents(l){if('String'!=typeof%20l.isSel){l.isSel='';l.oldOnmouseover=l.onmouseover;l.oldOnmouseout=l.onmouseout;l.oldOnclick=l.onclick;l.onmouseover=over;l.onmouseout=out;l.onclick=clik}}function%20getSourceIndex(l){if(l.sourceIndex)return%20l.sourceIndex;i=0;var%20el;while(el=d.getElementsByTagName('*').item(i)){if(el==l)return%20i;++i}}function%20getOuterHTML(l){if(l.outerHTML)return%20l.outerHTML;var%20dv=d.createElement('div');dv.appendChild(l.cloneNode(true));return%20dv.innerHTML}function%20pp(){var%20i=0,m,ss=d.styleSheets,wk=/webkit/i.test(navigator.userAgent);if(ss&&!wk){for(i=0;i<ss.length;i++){m=ss[i].media;if(m.mediaText)m.mediaText=media(m.mediaText);else%20ss[i].media=media(m)}}else{ss=[];var%20r,l;while(l=d.getElementsByTagName('link').item(i++)){r=l.getAttribute('rel');if(r&&/^style/i.test(r))ss.push(l)}i=0;while(l=d.getElementsByTagName('style').item(i++))ss.push(l);for(i=ss.length-1;i>=0;i--){if(wk)handleWk(ss[i]);else%20ss[i].media=media(ss[i].media)}}function%20media(m){return(m=='all')?m:(/projection/.test(m))?'print':(/speech/.test(m))?'screen':(/print/.test(m))?'screen,print,projection':'speech'}function%20handleWk(l){if(/print/.test(l.media)){var%20n=l.cloneNode(true);n.media='screen';l.parentNode.appendChild(n)}else%20if(/screen/.test(l.media)){l.disabled=true}}}})();